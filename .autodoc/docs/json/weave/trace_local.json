{
  "fileName": "trace_local.py",
  "filePath": "weave/trace_local.py",
  "url": "https://github.com/wandb/weave/weave/trace_local.py",
  "summary": "This code defines a TraceLocal class that provides methods for managing runs and saving objects in the Weave project. The TraceLocal class has methods for creating new runs, getting runs by their RunKey, saving runs, saving run outputs, and saving objects. \n\nThe make_run_key method generates a unique RunKey for a given OpDef and input_refs. The RunKey is used to identify a specific run of an operation. The _value_id method generates a unique identifier for a given value by hashing its JSON representation. This identifier is used to compare values and determine if they are the same. \n\nThe TraceLocal class uses the RunKey to manage runs. The new_run method creates a new run with the given RunKey, inputs, and output. The save_run method saves a run to storage. The get_run method retrieves a run by its RunKey. The get_run_val method retrieves the value of a run by its RunKey. The save_run_output method saves the output of a run to storage. The save_object method saves an object to storage. \n\nOverall, this code provides functionality for managing runs and storing objects in the Weave project. It is likely used in conjunction with other modules in the project to execute and manage operations. \n\nExample usage:\n\n```\nfrom weave import TraceLocal, op_def\n\n# create a TraceLocal instance\ntrace = TraceLocal()\n\n# define an OpDef\nmy_op = op_def.OpDef(name=\"my_op\", version=\"1.0\", inputs=[], outputs=[])\n\n# create a RunKey for a new run of my_op\nrun_key = trace.make_run_key(my_op, {})\n\n# create a new run with the given RunKey and inputs\nrun_node = trace.new_run(run_key, inputs={})\n\n# save the run to storage\ntrace.save_run(run_node.value)\n\n# retrieve the run by its RunKey\nrun_node = trace.get_run(run_key)\n\n# retrieve the value of the run\nrun_val = trace.get_run_val(run_key)\n\n# save the output of the run to storage\ntrace.save_run_output(my_op, run_key, \"output\")\n\n# save an object to storage\nobj_ref = trace.save_object(\"object\")\n```",
  "questions": "1. What is the purpose of the `TraceLocal` class?\n- The `TraceLocal` class is used to store trace data and manually construct nodes and op calls to avoid recursively calling the execute engine.\n\n2. What is the purpose of the `make_run_key` function?\n- The `make_run_key` function generates a unique key for a given operation definition and input references, which is used to identify a specific run of that operation.\n\n3. What is the purpose of the `_should_save_to_table` method?\n- The `_should_save_to_table` method determines whether a given run should be saved to a table cache based on the operation's simple name and a predefined policy."
}